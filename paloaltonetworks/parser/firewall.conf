{
  attributes: {
    "dataSource.category": "security",
    "dataSource.name": "Palo Alto",
    "dataSource.vendor": "Palo Alto"
  }
  patterns: {
   //maps to high_resolution_timestamp:
   timestamp: "\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}.\\d{3}(\\+|-)\\d{2}:\\d{2}"
   //application_characteristic can be a single value, a comma delimited list in quotes, or blank. Null value is handled by format: traffic-2, not by this pattern.
   app_characteristic: "(\".*\")|[^,]+"
   //description field from system log is wrapped in quotes and may contain commas"
   desc: "(\".*\")"   
  }
  
  formats: [
    {
      format: ".*$timestamp=timestamp$(\\,)*",
    }, 
    {
      //match all fields. application_characteristic can be a single value, or a comma delimited list in quotes. 
      id: "traffic-1",
      attributes: { "event.type": "TRAFFIC", format: "traffic-1" },
      format: "\\d+,$receive_time$,$firewall.serial_number$,TRAFFIC,$event.category$,\\d+,$created_time_dt$,$network_endpoint.src_endpoint_ip$,$network_endpoint.dst_endpoint_ip$,$network_endpoint.src_endpoint_nat$,$network_endpoint.dst_endpoint_nat$,$rule.name$,$user.src_name$,,$app_name$,$firewall.virtual_system_id$,$client_is_trusted$,$isp_is_trusted$,$network_interface.inbound_name$,$network_interface.outbound_name$,$log_action$,$time$,$session.uid$,$repeat_count$,$network_endpoint.src_port$,$network_endpoint.dst_port$,$network_endpoint.src_nat_port$,$network_endpoint.dst_nat_port$,$network_connection_info.flag$,$network_connection_info.protocol_name$,$action$,$network_traffic.bytes$,$network_traffic.bytes_out$,$network_traffic.bytes_in$,$network_traffic.packets$,$start_time$,$elapsed_time$,$category_name$,$test$,$device_hardware_info.serial_number$,.*,$location.src_country$,$location.dst_country$,,$network_traffic.packets_out$,$network_traffic.packets_in$,$session.expiration_reason$,\\d+,\\d+,\\d+,\\d+,$firewall.virtual_system_name$,$device.name$,$action_source$,$virtual_macine.src_vm_uuid$,$virtual_macine.dst_vm_uuid$,$device.imsi$,$device.imei$,$session.parent_uid$,$session.parent_created_time$,$network_connection_info.tunnel_type$,$network_connection_info.sctp_id$,$network_connection_info.sctp_chunks$,$network_connection_info.sctp_chunks_sent$,$network_connection_info.sctp_chunks_received$,$rule.uid$,$http_2_connection$,$network_connection_info.app_flap_count$,$policy.uid$,$network_connection_info.link_switches$,$network_connection_info.sd_wan_cluster$,$network_connection_info.sd_wan_device_type$,$network_connection_info.sd_wan_cluster_type$,$network_connection_info.sd_wan_site$,$user.groups$,$http_request.x_forwarded_for$,$device.src_type$,$device.src_profile$,$device.src_model$,$device.src_vendor_name$,$device.src_os.edition$,$device.src_os.version$,$network_connection_info.src_hostname$,$network_connection_info.src_mac$,$device.dst_type$,$device.dst_profile$,$device.dst_model$,$device.dst_vendor_name$,$device.dst_os.edition$,$device.dst_os.version$,$network_connection_info.dst_hostname$,$network_connection_info.dst_mac$,$container.id$,$container.pod_namespace$,$container.pod_name$,$network_endpoint.src_host_list$,$network_endpoint.dst_host_list$,$network_endpoint.host_id$,$device_hardware_info.serial_number$,$policy.src_group$,$policy.dst_group$,$session.owner$,$time_dt$,.*,.*,$sub_category$,$category_name$,$app_model$,$severity$,$app_characteristic=app_characteristic$,$container.id$,$app_tunnel_type$,$is_saas$,$is_sanctioned$,$is_offloaded$",
      halt: true
    },
    {
      //dont match on application_characteristic for cases where is it blank.
      id: "traffic-2",
      attributes: { "event.type": "TRAFFIC", format: "traffic-2" },
      format: ".*,$receive_time$,$firewall_serial_number$,TRAFFIC,$event.category$,.*,$created_time_dt$,$network_endpoint.src_endpoint_ip$,$network_endpoint.dst_endpoint_ip$,$network_endpoint.src_endpoint_nat$,$network_endpoint.dst_endpoint_nat$,$rule.name$,$user.src_name$,$user.dst_name$,$app_name$,$firewall.virtual_system_id$,$client_is_trusted$,$isp_is_trusted$,$network_interface.inbound_name$,$network_interface.outbound_name$,$log_action$,$time$,$user.id$,$repeat_count$,$network_endpoint.src_port$,$network_endpoint.dst_port$,$network_endpoint.src_nat_port$,$network_endpoint.dst_nat_port$,$network_connection_info.tcp_flags$,$network_connection_info.protocol_name$,$action$,$network_traffic.bytes$,$network_traffic.bytes_out$,$network_traffic.bytes_in$,$network_traffic.packets$,$start_time$,$elapsed_time$,$category_name$,$test$,$device_hardware_info.serial_number$,.*,$location.src_country$,$location.dst_country$,.*,$network_traffic.packets_out$,$network_traffic.packets_in$,$session.expiration_reason$,.*,.*,.*,.*,$firewall.virtual_system_name$,$device.name$,$action_source$,$virtual_macine.src_vm_uuid$,$virtual_macine.dst_vm_uuid$,$device.imsi$,$device.imei$,$session.parent_uid$,$session.parent_created_time$,$network_connection_info.tunnel_type$,$network_connection_info.sctp_id$,$network_connection_info.sctp_chunks$,$network_connection_info.sctp_chunks_sent$,$network_connection_info.sctp_chunks_received$,$rule.uid$,$http_2_connection$,$network_connection_info.app_flap_count$,$policy.uid$,$network_connection_info.link_switches$,$network_connection_info.sd_wan_cluster$,$network_connection_info.sd_wan_device_type$,$network_connection_info.sd_wan_cluster_type$,$network_connection_info.sd_wan_site$,$user.groups$,$http_request.x_forwarded_for$,$device.src_type$,$device.src_profile$,$device.src_model$,$device.src_vendor_name$,$device.src_os.edition$,$source_device_os_version$,$network_connection_info.src_hostname$,$network_connection_info.src_mac$,$device.dst_type$,$device.dst_profile$,$device.dst_model$,$device.dst_vendor_name$,$device.dst_os.edition$,$device.dst_os.version$,$network_connection_info.dst_hostname$,$network_connection_info.dst_mac$,$container_id$,$container.pod_namespace$,$container.pod_name$,$network_endpoint.src_host_list$,$network_endpoint.dst_host_list$,$network_endpoint.host_id$,$device_hardware_info.serial_number$,$policy.src_group$,$policy.dst_group$,$session.owner$,$time_dt$,.*,.*,$sub_category$,$category_name$,$app_model$,$severity$,.*,.*,$app_tunnel_type$,$is_saas$,$is_sanctioned$,$is_offloaded$",
      halt: true
    },
    {
      id: "system",
      attributes: { "event.type": "SYSTEM", format: "system" },
      format: ".*,$receive_time$,$device_hardware_info.serial_number$,SYSTEM,$event.category$,.*,$created_time_dt$,$firewall.virtual_system_id$,$activity_name$,$observables$,.*,.*,$enrichments$,$severity$,$desc=desc$,$device_hardware_info.serial_number$,.*,.*,.*,.*,.*,$firewall.virtual_system_name$,$device.name$,.*,.*,$time_dt$",
      halt: true
    },
    {
      //matches THREAT logs with comma surround lists in application_characteristic and url_category_list. 
      id: "threat-1",
      attributes: { "event.type": "THREAT", format: "threat-1" },
      format: ".*,$receive_time$,$device_hardware_info.serial_number$,THREAT,$event.category$,.*,$created_time_dt$,$network_endpoint.src_endpoint_ip$,$network_endpoint.dst_endpoint_ip$,$network_endpoint.src_endpoint_nat$,$network_endpoint.dst_endpoint_nat$,$rule.name$,$user.src_name$,$user.dst_name$,$app_name$,$firewall.virtual_system_id$,$client_is_trusted$,$isp_is_trusted$,$network_interface.inbound_name$,$network_interface.outbound_name$,$log_action$,.*,$session.uid$,$repeat_count$,$network_endpoint.src_port$,$network_endpoint.dst_port$,$network_endpoint.src_nat_port$,$network_endpoint.dst_nat_port$,$network_connection_info.flag$,$network_connection_info.protocol_name$,$action$,$url.text_file.name$,$threat.id$,$category_name$,$severity$,$network_traffic.direction$,$device_hardware_info.serial_number$,.*,$location.src_country$,$location.dst_country$,.*,$event.category$,$threat.pcap_id$,$file_digest$,.*,$url.index$,$http_request.user_agent$,$file.type$,$http_request.x_forwarded_for$,$http_request.referrer$,$email.smtp_from$,$email.subject$,$email.to$,$report_id$,.*,.*,.*,.*,$firewall.virtual_system_name$,$device.name$,.*,$virtual_macine.src_vm_uuid$,$virtual_macine.dst_vm_uuid$,$http_request.http_method$,$device.imsi$,$device.imei$,$session.parent_uid$,$session.parent_created_time$,$network_connection_info.tunnel_type$,$threat.category$,$app_ver$,.*,$network_connection_info.sctp_id$,$network_connection_info.protocol_id$,$http_request.http_header$,\"$url.category_ids$\",$rule.uid$,$http_2_connection$,$user.groups$,$http_request.x_forwarded_for$,$device.src_type$,$device.src_profile$,$device.src_model$,$device.src_vendor_name$,$device.src_os.edition$,$device.src_os.version$,$network_connection_info.src_hostname$,$network_connection_info.src_mac$,$device.dst_type$,$device.dst_profile$,$device.dst_model$,$device.dst_vendor_name$,$device.dst_os.edition$,$device.dst_os.version$,$network_connection_info.dst_hostname$,$network_connection_info.dst_mac$,$container.id$,$container.pod_namespace$,$container.pod_name$,$network_endpoint.src_host_list$,$network_endpoint.dst_host_list$,$network_endpoint.host_id$,$device_hardware_info.serial_number$,$domain.domain_edl$,$policy.src_group$,$policy.dst_group$,.*,$time_dt$,.*,.*,.*,$sub_category$,$category_name$,$app_model$,$severity$,\"$app_characteristic$\",$container.id$,$app_tunnel_type$,$is_saas$,$is_sanctioned$",
      halt: true
    },
    {
      //matches THREAT logs without comma surround list in url_category_list. 
      id: "threat-2",
      attributes: { "event.type": "THREAT", format: "threat-2" },
      format: ".*,$receive_time$,$device_hardware_info.serial_number$,THREAT,$event.category$,.*,$created_time_dt$,$network_endpoint.src_endpoint_ip$,$network_endpoint.dst_endpoint_ip$,$network_endpoint.src_endpoint_nat$,$network_endpoint.dst_endpoint_nat$,$rule.name$,$user.src_name$,$user.dst_name$,$app_name$,$firewall.virtual_system_id$,$client_is_trusted$,$isp_is_trusted$,$network_interface.inbound_name$,$network_interface.outbound_name$,$log_action$,.*,$session.uid$,$repeat_count$,$network_endpoint.src_port$,$network_endpoint.dst_port$,$network_endpoint.src_nat_port$,$network_endpoint.dst_nat_port$,$network_connection_info.flag$,$network_connection_info.protocol_name$,$action$,$url.text_file.name$,$threat.id$,$category_name$,$severity$,$network_traffic.direction$,$device_hardware_info.serial_number$,.*,$location.src_country$,$location.dst_country$,.*,$event.category$,$threat.pcap_id$,$file_digest$,.*,$url.index$,$http_request.user_agent$,$file.type$,$http_request.x_forwarded_for$,$http_request.referrer$,$email.smtp_from$,$email.subject$,$email.to$,$report_id$,.*,.*,.*,.*,$firewall.virtual_system_name$,$device.name$,.*,$virtual_macine.src_vm_uuid$,$virtual_macine.dst_vm_uuid$,$http_request.http_method$,$device.imsi$,$device.imei$,$session.parent_uid$,$session.parent_created_time$,$network_connection_info.tunnel_type$,$threat.category$,$app_ver$,.*,$network_connection_info.sctp_id$,$network_connection_info.protocol_id$,$http_request.http_header$,$url.category_ids$,$rule.uid$,$http_2_connection$,$user.groups$,$http_request.x_forwarded_for$,$device.src_type$,$device.src_profile$,$device.src_model$,$device.src_vendor_name$,$device.src_os.edition$,$device.src_os.version$,$network_connection_info.src_hostname$,$network_connection_info.src_mac$,$device.dst_type$,$device.dst_profile$,$device.dst_model$,$device.dst_vendor_name$,$device.dst_os.edition$,$device.dst_os.version$,$network_connection_info.dst_hostname$,$network_connection_info.dst_mac$,$container.id$,$container.pod_namespace$,$container.pod_name$,$network_endpoint.src_host_list$,$network_endpoint.dst_host_list$,$network_endpoint.host_id$,$device_hardware_info.serial_number$,$domain.domain_edl$,$policy.src_group$,$policy.dst_group$,.*,$time_dt$,.*,.*,.*,$sub_category$,$category_name$,$app_model$,$severity$,\"$app_characteristic$\",$container.id$,$app_tunnel_type$,$is_saas$,$is_sanctioned$",
      halt: true
    },
    {
      //matches THREAT logs without comma surround list in url_category_list or application_characteristic.
      id: "threat-3",
      attributes: { "event.type": "THREAT", format: "threat-3" },
      format: ".*,$receive_time$,$device_hardware_info.serial_number$,THREAT,$event.category$,.*,$created_time_dt$,$network_endpoint.src_endpoint_ip$,$network_endpoint.dst_endpoint_ip$,$network_endpoint.src_endpoint_nat$,$network_endpoint.dst_endpoint_nat$,$rule.name$,$user.src_name$,$user.dst_name$,$app_name$,$firewall.virtual_system_id$,$client_is_trusted$,$isp_is_trusted$,$network_interface.inbound_name$,$network_interface.outbound_name$,$log_action$,.*,$session.uid$,$repeat_count$,$network_endpoint.src_port$,$network_endpoint.dst_port$,$network_endpoint.src_nat_port$,$network_endpoint.dst_nat_port$,$network_connection_info.flag$,$network_connection_info.protocol_name$,$action$,$url.text_file.name$,$threat.id$,$category_name$,$severity$,$network_traffic.direction$,$device_hardware_info.serial_number$,.*,$location.src_country$,$location.dst_country$,.*,$event.category$,$threat.pcap_id$,$file_digest$,.*,$url.index$,$http_request.user_agent$,$file.type$,$http_request.x_forwarded_for$,$http_request.referrer$,$email.smtp_from$,$email.subject$,$email.to$,$report_id$,.*,.*,.*,.*,$firewall.virtual_system_name$,$device.name$,.*,$virtual_macine.src_vm_uuid$,$virtual_macine.dst_vm_uuid$,$http_request.http_method$,$device.imsi$,$device.imei$,$session.parent_uid$,$session.parent_created_time$,$network_connection_info.tunnel_type$,$threat.category$,$app_ver$,.*,$network_connection_info.sctp_id$,$network_connection_info.protocol_id$,$http_request.http_header$,$url.category_ids$,$rule.uid$,$http_2_connection$,$user.groups$,$http_request.x_forwarded_for$,$device.src_type$,$device.src_profile$,$device.src_model$,$device.src_vendor_name$,$device.src_os.edition$,$device.src_os.version$,$network_connection_info.src_hostname$,$network_connection_info.src_mac$,$device.dst_type$,$device.dst_profile$,$device.dst_model$,$device.dst_vendor_name$,$device.dst_os.edition$,$device.dst_os.version$,$network_connection_info.dst_hostname$,$network_connection_info.dst_mac$,$container.id$,$container.pod_namespace$,$container.pod_name$,$network_endpoint.src_host_list$,$network_endpoint.dst_host_list$,$network_endpoint.host_id$,$device_hardware_info.serial_number$,$domain.domain_edl$,$policy.src_group$,$policy.dst_group$,.*,$time_dt$,.*,.*,.*,$sub_category$,$category_name$,$app_model$,$severity$,$app_characteristic$,$container.id$,$app_tunnel_type$,$is_saas$,$is_sanctioned$",
      halt: true
    }
  ]
}
